---
title: "Guide to the [mSigAct web server](https://msigact.ai)"
author: "Steve Rozen and Nanhai Jiang"
output:
  md_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

The [mSigAct web server](https://msigact.ai){target="_blank"} provides methods for analyzing mutational 
signatures. "mSigAct" is an abbreviation of 
<big><strong>m</strong></big>utational 
<big><strong>Sig</strong></big>nature <big><strong>Act</strong></big>ivity. 
We usually view a mutational signature as the pattern of mutations generated 
by a particular 
mutational process. 

### Mutational signature examples

#### Mutations from CG to TG

```{r SBS1, echo=FALSE, fig.height=2.5, fig.width=9 }
par(mar=c(6,6,4,1))
par(cex = 0.8)
ICAMS::PlotCatalog(PCAWG7::signature$genome$SBS96[ , "SBS1", drop = FALSE])
```

These are kind of "single base substitution" (SBS)
caused by deamination of 5-methyl cytosine.
We most often look at
SBS mutations in the context of preceding and following bases. We also, by convention,
always look a mutations from C or T (not G or A -- we reverse complement if necessary).
In the figure above we see mutational signature "SBS1", which
is the signature of 5-methyl cytosine deamination. It consists 
almost entirely of mutations from ACG to ATG, CCG to CTG, GCG to GTG
and TCG to TTG. We call signatures based on SBS mutations in the 
context of the preceding and following bases "SBS96" signatures.
A compendium with standard nomenclature is at the 
[COSMIC Single Base Substitution web site](https://cancer.sanger.ac.uk/cosmic/signatures/SBS/index.tt){target="_blank"}.

We can also look a single base substitutions in the context of the
preceding and following 2 bases (giving us "SBS1536"
signatures), and we can also look at signatures of mutations
in transcripts by distinguishing their transcribed (antisense)
and untranscrbed (sense) strands (giving us "SBS192" 
signatures.)

#### Moderately-sized deletions with microhomology

```{r ID6, echo=FALSE, fig.height=2.5, fig.width=9 }
par(mar=c(5,6,4,1))
par(cex = 0.8)
ICAMS::PlotCatalog(PCAWG7::signature$genome$ID[ , "ID6", drop = FALSE])
```

These are common in tumors with defective 
homologous-recombination-based DNA-damage repair, often 
BRCA1 or BRCA2-deficient tumors.
The classification for insertions and deletions is
detailed at 
[https://www.synapse.org/#!Synapse:syn11801742](https://www.synapse.org/#!Synapse:syn11801742){target="_blank"}.

#### CC to TT mutations

```{r DBS1, echo=FALSE, fig.height=2.5, fig.width=9 }
par(mar=c(5,6,4,1))
par(cex = 0.9)
ICAMS::PlotCatalog(PCAWG7::signature$genome$DBS78[ , "DBS1", drop = FALSE])
```

These are a kind of 
of "doublet base substitution", (DBS)
mutations that stem from ultraviolet-radiation-induced pyrimidine dimers.
The classification of
DBSs is detailed at
[https://www.synapse.org/#!Synapse:syn11801895](https://www.synapse.org/#!Synapse:syn11801895){target="_blank"}

### A mutational spectrum is usually an overlay of multple mutational signatures

A single tumor or tissue sample usually contains mutations generated by
multiple mutational processes, each of which generates mutations that
when combined constitute the mutational spectrum of the sample,
as show in this figure:

```{r mutograph, echo=FALSE, out.width="60%"}
knitr::include_graphics("mutograph.png")
```

(Reproduced from 
[Alexandrov et al., 2020](https://www.nature.com/articles/s41586-020-1943-3){target="_blank"},
under the
[Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/){target="_blank"}

This breast cancer has an SBS96 spectrum generated by
an overlay of signatures SBS1, SBS2, SBS3, SBS5, and SBS13,
with SBS3 (the SBS signature of defective homologous-recombination-based
DNA repair) contributing the the bulk of the mutations.
The breast cancer's DBS spectrum has signatures 
DBS2, DBS4, DBS6, and DBS9. Its ID signature has ID1, ID6, and
ID8. The latter two indel signatures are characteristic of tumors with 
defective homologous-recombination-based
DNA repair, which is consistent with the large number of
mutations due to SBS3.


For more extensive background, please see 
[Alexandrov et al., 2020](https://www.nature.com/articles/s41586-020-1943-3){target="_blank"}.

The a list and plots of the the currently known mutational signatures, please
see
[https://cancer.sanger.ac.uk/cosmic/signatures/index.tt](https://cancer.sanger.ac.uk/cosmic/signatures/index.tt){target="_blank"}.

## Using the [mSigAct web server](https://msigact.ai){target="_blank"} to create mutational spectrum catalogs from variant call files and plot them

Please see the "Generate spectrum catalogs from VCFs"
tab for more information and examples.
The [mSigAct web server](https://msigact.ai){target="_blank"} can generate and 
plot mutational spectra from VCF files generated by
the Strelka or Mutect variant callers.

## Using the [mSigAct web server](https://msigact.ai){target="_blank"} to estimate mutational signature activities

individual mutational spectra. By "mutational signature activities"
we refer to the numbers of mutations generated by each
mutational signature (or more precisely, generated by each
mutational process). For the breast cancer example above, this
would involve which mutational signatures (processes)
generated the somatic mutations and how many mutations
each signature generated. This is in fact a challenging 
problem, and the purpose of this
functionality in the [mSigAct web server](https://msigact.ai){target="_blank"}
is to allow you to consider and examine all the evidence in this
analysis. Please see the "Upload spectra" tab for 
more information and examples.

## [mSigAct web server](https://msigact.ai){target="_blank"} testing

The [mSigAct web server](https://msigact.ai){target="_blank"} 
has been tested under the following browsers and operating systems

| OS      | Version | Chrome       | Edge           | Firefox | Safari |
|:-------:|:-------:|:------------:|:--------------:|:-------:|:------:|
| Linux   |         | need         |                |         |        |
| MacOS   |         | need         |  need          |         |  Need  |
| Windows | 10      | 87.0.4280.88 |  87.0.664.60   |  83.0   |        |  

## Code availability

The [mSigAct web server](https://msigact.ai){target="_blank"} code is available at 
github at 
[https://github.com/steverozen/mSigAct.server](https://github.com/steverozen/mSigAct.server){target="_blank"}
and is released under 
the GPL3
open source license. 
Other code used by the web
server includes [mSigAct](https://github.com/steverozen/mSigAct){target="_blank"}, 
[ICAMS](https://cran.r-project.org/package=ICAMS){target="_blank"}, 
[ICAMSxtra](https://github.com/steverozen/ICAMSxtra){target="_blank"}, and 
[PCAWG7](https://github.com/steverozen/PCAWG7){target="_blank"}, all released
under the GPL3 open source license.
